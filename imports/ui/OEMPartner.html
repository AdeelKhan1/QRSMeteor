<template name='OEMPartner'>
    <div class="ui segment">
        <div class="ui icon message">
            <img class="icon" src="images/intro.png">
            <div class="content">
                {{#if freshEnvironment}}
                <div class="header">
                    1: Let's start publishing apps for your customers
                </div>                
                <p>
                    First insert some customers in your SaaS platform
                </p>
                {{/if}}
                {{#if  readyToSelectTemplate}}
                <div class="header">
                    2: Select a template app
                </div>
                <p>
                    Select the "my first template" app on the right.
                </p>
                {{/if}}
                {{#if  readyToGenerate}}
                <div class="header">
                    3: Start publishing
                </div>
                <p>
                    Press the generate button to publish a copy of the template app in the "customer name" stream. Next to this we will also replace the script with a customer specific one. This to enable to connect to a specific database or load free tables and fields. (which are specific to each customer).
                </p>
                {{/if}}
                {{#if  templateButNoCustomer}}
                <div class="header">
                    Customers
                </div>
                <p>
                    You already selected a template, but please re-insert your customers.
                </p>
                {{/if}}
                {{#if  readyToTestSSO}}
                <div class="header">
                    4: Test Single Sign On
                </div>
                <p>
                    Select a user to test Single Sign On. For this user a ticket will be generated which inludes your SaaS platform's authorizations (the groups) in a dynamic way. This means you don't have to create users and roles in Sense. In the your <a class="item" href="{{webIntegrationDemo}}/hub" target="_blank">SaaS platform</a> menu you can see Qlik Sense embedded via IFrame's and DIV tags. On the other side, if you press any link on the current page you will go to Qlik Sense directly. See security integration <a href="{{pathFor 'introductionSecurity'}}" class="item">videos</a> for more information.
                </p>
                {{/if}}
                {{#if  loading}}
                <div class="header">
                    3: API communication is in progress...
                </div>
                <p>This application is now sending REST API calls to the Qlik Sense QRS and Engine API. You can view the HTTP REST requests and the responses in the <a href="{{pathFor 'APILogs'}}" class="item">QMC - API Calls menu</a></p>
                {{/if}}
            </div>
        </div>
    </div>
    {{#if readyToTestSSO}}
    <div class="ui segment">
        {{> simulateUserLogin}}
    </div>
    {{/if}}
    <div class="ui segment">
        <a class="ui {{loading}} labeled icon button" href="{{pathFor 'users'}}"> <i class="edit icon "></i>1: Insert Customers</a>
        <div class="ui buttons">
            <div class="ui buttons">
                <div class="ui {{loading}} button resetEnvironment"><i class="undo icon "></i> Initialize demo</div>
                <div class="ui floating dropdown icon button">
                    <i class="dropdown icon"></i>
                    <div class="menu">
                        <div class="item insertDummyCustomers"><i class="edit icon "></i> Insert dummy customers</div>
                        <div class="item deleteAllCustomers"><i class="delete icon "></i> Delete all customers</div>
                        <div class="item toggleAllCustomers"><i class="refresh icon"></i> Toggle the selected customers</div>
                    </div>
                </div>
            </div>
            {{#if readyToGenerate}}
            <div class="or"></div>
            <div class="ui {{loading}} primary button generateStreamAndApp"><i class="play icon "></i> 3: Generate</div>
            {{/if}}
        </div>
        {{#if noCustomers}}
        <div class="ui icon message">
            <img class="icon" src="images/customers.png">
            <div class="content">
                <div class="header">
                    <h4>No customers</h4>
                </div>
                <ul>
                    <li>You have no customers in your SaaS platform.</li>
                    <li>Let's <a href="{{pathFor 'users'}}"> insert some customers with users</a>, and after the generation is completed you can also test single sign on </li>
                    <li>Or <a class="insertDummyCustomers"> insert dummy customers</a> (use these if you want to test row level security)</li>
                </ul>
            </div>
        </div>
        {{else}}
        <div class="ui icon message">
            <img class="icon" src="images/customers.png">
            <div class="content">
                <div class="header">
                    <h4>{{NrCustomers}} Customers stored in the database of your SaaS platform </h4>
                </div>
            </div>
        </div>
        <table class="ui celled striped table">
            <thead>
                <tr>
                    <th>Customer</th>
                    <th>Delete customer</th>
                    <th>Generate stream</th>
                </tr>
            </thead>
            <tbody>
                {{#each customers}} {{> customer}} {{/each}}
            </tbody>
        </table>
        {{#if readyToSelectTemplate}} {{/if}} {{#if noTemplateApps}}
        <div class="ui icon message">
            <img class="icon" src="images/app.png">
            <div class="content">
                <div class="header">
                    <h4>No template apps</h4>
                </div>
                <p>Please select an app in the templates stream (on the right) which you would like to use as a basis template. We will create a copy and publish it into the "customer name" stream for each of your selected customers</p>
            </div>
        </div>
        {{else}}
        <div class="ui icon message">
            <img class="icon" src="images/app.png">
            <div class="content">
                <div class="header">
                    <h4>Template apps</h4>
                </div>
                <p>We will create a customer stream and publish a copy of each template app</p>
            </div>
        </div>
        <table class="ui celled table">
            <thead>
                <tr>
                    <th>App (QVF)</th>
                    <th>Don't mark as template</th>
                </tr>
            </thead>
            <tbody>
                {{#each templateApps}}
                <tr>
                    <td> <a href={{linkToApp}} target=_blank> {{name}} </a></td>
                    <td class="removeTemplateApp"><i class="remove circle icon"></i></td>
                </tr>
                {{/each}}
            </tbody>
        </table>
        {{/if}} {{/if}}
    </div>
</template>
